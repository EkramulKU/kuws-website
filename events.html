<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Events | KU Writers' Society</title>

<script src="https://cdn.tailwindcss.com"></script>

<script>
tailwind.config = {
  theme: {
    extend: {
      fontFamily: { sans: ['Inter', 'sans-serif'] },
      colors: {
        'ku-blue': '#1a3a60',
        'ku-gold': '#ffb703',
        'ku-light': '#f0f4f8',
      }
    }
  }
}
</script>
</head>

<body class="bg-ku-light text-gray-800" id="top">

<!-- Header -->
<header class="bg-ku-blue shadow-lg sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-20">
      <a href="index.html" class="flex items-center space-x-3">
        <img src="images/logo.jpg" class="h-10 w-10 rounded-full object-cover">
        <span class="text-2xl font-bold text-white">KU Writers' Society</span>
      </a>

      <nav class="hidden md:flex space-x-8">
        <a href="index.html" class="text-white hover:text-ku-gold">Home</a>
        <a href="events.html" class="text-white hover:text-ku-gold">Events</a>
        <a href="gallery.html" class="text-white hover:text-ku-gold">Gallery</a>
      </nav>

      <button id="mobile-menu-button" class="md:hidden text-white">
        ☰
      </button>
    </div>
  </div>

  <div id="mobile-menu" class="hidden md:hidden bg-ku-blue pb-4">
    <a href="index.html" class="block px-4 py-2 text-white">Home</a>
    <a href="events.html" class="block px-4 py-2 text-white">Events</a>
    <a href="gallery.html" class="block px-4 py-2 text-white">Gallery</a>
  </div>
</header>

<!-- Page Title -->
<div class="bg-ku-blue text-white py-10 text-center">
  <h1 class="text-4xl font-extrabold">Upcoming Literary Events</h1>
</div>

<!-- Events -->
<main class="py-16">
  <div id="event-list" class="max-w-6xl mx-auto px-4 space-y-6">
    <p class="text-gray-500">Loading events...</p>
  </div>
</main>

<!-- Footer -->
<footer class="bg-ku-blue text-white py-10">
  <div class="text-center text-sm text-gray-300">
    © <span id="year"></span> Khulna University Writers' Society
  </div>
</footer>

<!-- Go Up Button -->
<a href="#top" class="fixed bottom-6 right-6 p-3 bg-ku-blue text-white rounded-full shadow-lg hover:bg-ku-blue/80 z-50">
  ↑
</a>

<script>
/* year */
document.getElementById('year').textContent = new Date().getFullYear();

/* mobile menu */
const btn = document.getElementById('mobile-menu-button');
const menu = document.getElementById('mobile-menu');
btn.addEventListener('click', () => menu.classList.toggle('hidden'));

/* fetch events */
fetch('https://api.github.com/repos/EkramulKU/kuws-website/contents/content/events?ref=main', {
  cache: 'no-store'
})
.then(res => res.json())
.then(files => {
  const container = document.getElementById('event-list');
  container.innerHTML = '';

  files
    .filter(f => f.name.endsWith('.md'))
    .reverse()
    .forEach(file => {
      fetch(file.download_url)
        .then(r => r.text())
        .then(text => {

          const title = text.match(/title:\s*(.*)/)?.[1] || '';
          const shortDesc = text.match(/short_description:\s*(.*)/)?.[1] || '';
          const location = text.match(/location:\s*(.*)/)?.[1] || '';
          const start = text.match(/start_date:\s*(.*)/)?.[1] || '';
          const cover = text.match(/cover:\s*(.*)/)?.[1] || '';
          const slug = file.name.replace('.md','');

          const dateObj = new Date(start);

          const card = document.createElement('div');
          card.className = "md:flex bg-white rounded-xl shadow-lg p-6 border-l-8 border-ku-gold";

          card.innerHTML = `
            <div class="md:w-48 text-center mb-4 md:mb-0">
              <div class="bg-ku-blue text-white rounded-lg p-4">
                <div class="text-4xl font-bold">${dateObj.getDate()}</div>
                <div class="text-lg">${dateObj.toLocaleString('default',{month:'short'})}</div>
              </div>
            </div>

            <div class="md:ml-6">
              <h3 class="text-2xl font-bold text-ku-blue mb-2">
                <a href="event.html?slug=${slug}" class="hover:underline">${title}</a>
              </h3>
              <p class="text-gray-600 mb-3">${shortDesc}</p>
              <p class="text-sm text-gray-500">Location: ${location}</p>
              ${cover ? `<img src="${cover}" class="mt-4 w-full h-48 object-cover rounded-md">` : ''}
            </div>
          `;

          container.appendChild(card);
        });
    });
});
</script>

</body>
</html>
